# FAQ

redteam-skillsに関するよくある質問。

## Q1. 全エージェント実行すべき？

**A**: プロジェクトの特性に応じて選択することを推奨します。

- **フルスキャン推奨**: 初回監査、リリース前、重要なセキュリティレビュー
- **選択的スキャン推奨**: 日常的なチェック、特定機能の追加時

`/security-scan`はフレームワークを自動検出し、関連性の高いエージェントを優先的に実行します。全エージェントを常に実行する必要はありません。

---

## Q2. 動的検証（dynamic）はいつ使う？

**A**: 以下の場合に有効です。

- 静的解析で検出された脆弱性の**確度を上げたい**とき
- **誤検知を減らしたい**とき
- **実際のエクスプロイト可能性**を確認したいとき

**注意**: 動的検証には稼働中のアプリケーションが必要です。本番環境では実行しないでください。

```bash
/security-scan ./src --dynamic --target http://localhost:8000
```

---

## Q3. E2Eテスト生成のタイミングは？

**A**: 脆弱性が検出され、修正後の**回帰テスト**が必要な場合に使用します。

1. `/security-scan`で脆弱性を検出
2. 脆弱性を修正
3. E2Eテストを生成して修正を検証
4. CI/CDに組み込んで再発防止

E2Eテストは Playwright 形式で生成されます。

---

## Q4. 誤検知が多い場合は？

**A**: 以下の対策があります。

1. **false-positive-filter**を有効化（デフォルトで有効）
2. **dynamic検証**を有効化して実際の脆弱性のみ抽出
3. `.redteam-ignore`ファイルで特定パターンを除外

```bash
# .redteam-ignore の例
tests/**/*
vendor/**/*
node_modules/**/*
```

---

## Q5. 特定の脆弱性だけ検査したい

**A**: 現在、個別エージェントの直接呼び出しはサポートしていませんが、`/security-scan`の結果から特定の脆弱性タイプをフィルタできます。

将来的には以下のような機能を検討中:
```bash
# 計画中の機能
/security-scan ./src --only injection,xss
```

---

## Q6. recon-agentは必須？

**A**: 必須ではありませんが、**強く推奨**します。

recon-agentの利点:
- スキャン対象の**優先度付け**
- フレームワーク検出による**適切なエージェント選択**
- エンドポイント一覧による**網羅的なスキャン**

recon-agentをスキップすると、一部のコンテキスト情報が欠落し、検出精度が下がる可能性があります。

---

## Q7. SCAスキャンの頻度は？

**A**: 以下を推奨します。

| タイミング | 推奨度 |
|-----------|--------|
| 依存関係更新時 | 必須 |
| 週次 | 推奨 |
| CI/CDパイプライン | 推奨 |
| リリース前 | 必須 |

SCA (Software Composition Analysis) は`sca-attacker`が担当し、OSV Databaseを参照して既知のCVEを検出します。

---

## Q8. CVSSスコアの解釈方法は？

**A**: CVSS 4.0に基づくスコアリングです。

| スコア | 重大度 | 対応 |
|--------|--------|------|
| 9.0-10.0 | Critical | 即時対応 |
| 7.0-8.9 | High | 優先対応 |
| 4.0-6.9 | Medium | 計画的対応 |
| 0.1-3.9 | Low | 任意対応 |
| 0.0 | None | 情報提供 |

attack-reportで自動計算されます。ただし、**ビジネスコンテキスト**を加味した最終判断は人間が行ってください。

---

## Q9. レポートのカスタマイズは可能？

**A**: 現在、以下の形式をサポートしています。

- **JSON**: 機械可読、CI/CD統合向け
- **Markdown**: 人間可読、レビュー向け

カスタムテンプレートは現在サポートしていませんが、JSON出力を加工することで任意の形式に変換できます。

---

## Q10. CI/CDに組み込める？

**A**: 可能ですが、現時点では手動設定が必要です。

**GitHub Actions例**:
```yaml
- name: Security Scan
  run: |
    claude-code /security-scan ./src --output json > security-report.json
    # レポートをアーティファクトとして保存
```

**注意**: Claude Codeの実行にはAPI認証が必要です。CI/CD環境での利用方法は今後ドキュメント化予定です。

---

## Q11. WordPress以外のCMSは対応？

**A**: 現在、WordPress専用のエージェント（`wordpress-attacker`）のみ提供しています。

他のCMS（Drupal、Joomla等）は汎用エージェントで一部カバーされますが、CMS固有の脆弱性は検出できない場合があります。

今後のロードマップ:
- Drupal対応は検討中
- コントリビューション歓迎

---

## Q12. APIのみのプロジェクトはどう検査？

**A**: 以下のエージェントを重点的に使用します。

| エージェント | 理由 |
|--------------|------|
| api-attacker | BOLA/BFLA/Mass Assignment |
| auth-attacker | 認証・認可 |
| injection-attacker | SQLi/NoSQLi |
| ssrf-attacker | 外部リクエスト |
| crypto-attacker | JWT/暗号化 |

XSS/CSRFはフロントエンドがない場合は優先度を下げられます。

---

## Q13. attack-scenarioの使いどころは？

**A**: 複数の脆弱性が検出された場合に、**リスクの全体像**を把握するために使用します。

例:
1. XSS検出
2. セッション管理の脆弱性検出
3. attack-scenarioが「XSS → セッションハイジャック → 管理者権限奪取」のシナリオを提案

これにより、個々の脆弱性の**ビジネスインパクト**を評価しやすくなります。

---

## Q14. context-reviewとの違いは？

**A**: 目的が異なります。

| 機能 | 目的 |
|------|------|
| security-scan | **自動検出**: パターンマッチによる脆弱性検出 |
| context-review | **対話型レビュー**: ビジネスロジック脆弱性の発見支援 |

context-reviewは自動検出が難しい以下のケースに有効:
- 権限チェックの漏れ
- ビジネスロジックの欠陥
- 設計レベルの問題

両方を組み合わせることで、より包括的なセキュリティレビューが可能です。

---

## Q15. 検出されなかった＝安全？

**A**: **いいえ**。検出されないことは安全を保証しません。

redteam-skillsの限界:
- **静的解析の限界**: データフロー追跡が困難なケース
- **ビジネスロジック**: 自動検出が困難
- **ゼロデイ**: パターン未登録の脆弱性
- **設定ミス**: インフラレベルの問題

推奨アプローチ:
1. redteam-skillsで**既知パターン**を自動検出
2. context-reviewで**ビジネスロジック**をレビュー
3. 専門家による**手動ペンテスト**を併用
4. 継続的なセキュリティテストの実施
