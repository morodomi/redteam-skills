# TDD Cycle: OWASP 2025 Integration

## Overview

| Item | Value |
|------|-------|
| Feature | OWASP 2025 Integration（Phase 3） |
| Issue | #10 |
| Phase | GREEN |
| Started | 2025-12-25 00:37 |

## Environment

| Tool | Version |
|------|---------|
| Claude Code | 2.0.75 |
| Platform | darwin (macOS) |

## Goal

Issue #10 Phase 3: 新規エージェント（crypto-attacker, error-attacker）をsecurity-scan/attack-reportに統合する。

### 前提条件

- Phase 1: crypto-attacker 完了 (49e176c)
- Phase 2: error-attacker 完了 (49e176c)

### MVP対象

| Task | Description |
|------|-------------|
| security-scan統合 | 新エージェントをSCAN Phaseに追加 |
| attack-report統合 | CVSS/CWEマッピング追加 |

## Background

### 現在のsecurity-scan Agent Integration

| Phase | Agent | Role |
|-------|-------|------|
| RECON | recon-agent | 情報収集・優先度付け |
| SCAN | injection-attacker | SQLインジェクション検出 |
| SCAN | xss-attacker | XSS脆弱性検出 |

### 追加予定

| Phase | Agent | Role |
|-------|-------|------|
| SCAN | crypto-attacker | 暗号・設定脆弱性検出 |
| SCAN | error-attacker | 例外処理脆弱性検出 |

## PLAN

### スコープ

既存のsecurity-scan/attack-reportスキルに新エージェントを統合する。

### ファイル更新

```
plugins/redteam-core/skills/
├── security-scan/
│   ├── SKILL.md          # UPDATE: Workflow, Agent Integration
│   └── reference.md      # UPDATE: Phase 2 SCAN, Limitations, References
└── attack-report/
    └── reference.md      # UPDATE: CVSS/CWE Mapping, Agent to Type Mapping
```

### 変更内容

#### 1. security-scan/SKILL.md

**Workflow更新**:
```
2. SCAN Phase（並行実行）
   ├── injection-attacker（SQLi検出）
   ├── xss-attacker（XSS検出）
   ├── crypto-attacker（暗号・設定脆弱性）  # NEW
   └── error-attacker（例外処理脆弱性）     # NEW
```

**Agent Integration更新**:
| Phase | Agent | Role |
|-------|-------|------|
| SCAN | crypto-attacker | 暗号・設定脆弱性検出 |
| SCAN | error-attacker | 例外処理脆弱性検出 |

#### 2. security-scan/reference.md

**Phase 2 SCAN更新**:
| Agent | Detection Target |
|-------|-----------------|
| crypto-attacker | Debug mode, Weak hash/crypto, Default credentials, CORS |
| error-attacker | Empty catch, Fail-open, Generic exception |

**Limitations更新**:
- MVP対象: SQLi, XSS, **Crypto, Error Handling**
- 対応済: auth-attacker, api-attacker, **crypto-attacker, error-attacker**

**References追加**:
- crypto-attacker, error-attacker

#### 3. attack-report/reference.md

**CVSS 4.0 Mapping追加**（Phase 1-2で設計済）:
- debug-enabled, weak-hash, weak-crypto, default-credentials, insecure-cors
- empty-catch, swallowed-exception, fail-open, generic-exception, missing-finally

**CWE Mapping追加**:
- CWE-489, CWE-328, CWE-327, CWE-1392, CWE-942
- CWE-390, CWE-391, CWE-636, CWE-396, CWE-404

**Agent to Type Mapping追加**:
| Agent | Default Type |
|-------|--------------|
| crypto-attacker | weak-crypto |
| error-attacker | empty-catch |

## Test List

### DONE
- [x] TC-17: security-scan SKILL.mdにcrypto-attacker統合
- [x] TC-18: security-scan SKILL.mdにerror-attacker統合
- [x] TC-19: security-scan reference.mdに新エージェント追加
- [x] TC-20: attack-report reference.mdに新CVSSマッピング追加（10件）
- [x] TC-21: attack-report reference.mdに新CWEマッピング追加（10件）
- [x] TC-22: attack-report reference.mdにAgent to Type Mapping追加

## Phase Log

| Phase | Status | Note |
|-------|--------|------|
| INIT | Done | Cycle doc作成 |
| PLAN | Done | 統合設計完了、Test List 6件 |
| RED | Done | 6テスト失敗確認 |
| GREEN | Done | 6テスト全PASS |
| REFACTOR | Done | リファクタリング不要（ドキュメント更新のみ） |
| REVIEW | Done | code-review 3観点完了、Critical 0件 |
| COMMIT | - | |
