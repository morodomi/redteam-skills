# Cycle: cvss-auto-calc

| Item | Value |
|------|-------|
| Issue | #37 |
| Phase | DONE |
| Created | 2026-01-09 10:56 |

## Environment

| Tool | Version |
|------|---------|
| Node.js | v22.17.0 |

## Goal

検出した脆弱性からCVSS 4.0スコアを自動算出する機能を追加。

## Background

From Issue #37:
- CVSS 4.0 Base Metrics対応
- 脆弱性タイプからスコア推定
- attack-reportスキル拡張

## Scope

From Issue #37:
- [ ] attack-reportスキル拡張
- [ ] CVSS計算ロジック（ガイダンス形式）
- [ ] Output FormatにCVSS追加
- [ ] テストスクリプト作成

## PLAN

### Background

attack-reportスキルのreference.mdに既存のCVSS 4.0マッピングがあるが、
v2.2/v2.3で追加した新規アタッカーの脆弱性タイプが未対応。

### Design

1. **reference.md拡張**: 不足しているvulnerability_classのCVSSマッピングを追加
2. **Agent to Type Mapping更新**: 新規アタッカーのデフォルトタイプを追加
3. **CWE/OWASP Mapping更新**: 新規脆弱性タイプの参照を追加
4. **テストスクリプト作成**: マッピングの完全性を検証

### Files to Modify

| File | Change |
|------|--------|
| plugins/redteam-core/skills/attack-report/reference.md | CVSS/Agent/CWE マッピング追加 |
| scripts/test-cvss-mapping.sh | 新規作成 |

### New CVSS Mappings (CVSS 4.0)

| vulnerability_class | Vector | Score | Severity |
|---------------------|--------|-------|----------|
| ssti | AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N | 9.3 | Critical |
| xxe | AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:N/VA:N/SC:H/SI:N/SA:N | 8.2 | High |
| object-injection | AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N | 9.3 | Critical |

NOTE: xss-domは既存の"xss"クラスを維持（typeフィールドで区別、既存パターン踏襲）

## Test List

### TODO

### WIP

### DONE
- [x] TC-01: ssti マッピング存在確認
- [x] TC-02: xxe マッピング存在確認
- [x] TC-03: object-injection マッピング存在確認
- [x] TC-04: Agent to Type Mapping にssti-attacker存在
- [x] TC-05: Agent to Type Mapping にxxe-attacker存在
- [x] TC-06: Agent to Type Mapping にwordpress-attacker存在
- [x] TC-07: CWE/OWASP Mapping にssti存在
- [x] TC-08: CWE/OWASP Mapping にxxe存在
- [x] TC-09: CWE/OWASP Mapping にobject-injection存在

## REVIEW

### Test Results
- 9 passed, 0 failed

### quality-gate Results
| Reviewer | Score |
|----------|-------|
| Correctness | 25 |
| Security | 0 |
| Performance | 0 |
| Guidelines | 5 |
| **Max** | **25** |

**Result: PASS**

## Notes

- v3.0 マイルストーン
- CVSS 4.0仕様準拠
